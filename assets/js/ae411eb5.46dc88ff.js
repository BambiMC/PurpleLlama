"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[873],{8453:(e,n,a)=>{a.d(n,{R:()=>c,x:()=>i});var t=a(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}},8713:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"documentation/advanced-usage/adding-custom-scanner","title":"Adding a Custom Scanner","description":"LlamaFirewall is a modular security system that allows developers to create custom scanners to detect and prevent specific types of threats. In this guide, we will walk you through the process of creating a new custom scanner for LlamaFirewall.","source":"@site/docs/documentation/advanced-usage/adding-custom-scanner.md","sourceDirName":"documentation/advanced-usage","slug":"/documentation/advanced-usage/adding-custom-scanner","permalink":"/PurpleLlama/LlamaFirewall/docs/documentation/advanced-usage/adding-custom-scanner","draft":false,"unlisted":false,"editUrl":"https://github.com/meta-llama/PurpleLlama/tree/main/LlamaFirewall/website/docs/documentation/advanced-usage/adding-custom-scanner.md","tags":[],"version":"current","frontMatter":{},"sidebar":"documentationSidebar","previous":{"title":"PromptGuard 2","permalink":"/PurpleLlama/LlamaFirewall/docs/documentation/scanners/prompt-guard-2"}}');var s=a(4848),r=a(8453);const c={},i="Adding a Custom Scanner",o={},l=[{value:"Step 1: Define your scanner&#39;s purpose and functionality",id:"step-1-define-your-scanners-purpose-and-functionality",level:3},{value:"Step 2: Create a New Scanner Class",id:"step-2-create-a-new-scanner-class",level:3},{value:"Step 3: Implement Your Scanner&#39;s Logic",id:"step-3-implement-your-scanners-logic",level:3},{value:"Step 4: Register Your Scanner",id:"step-4-register-your-scanner",level:3}];function d(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"adding-a-custom-scanner",children:"Adding a Custom Scanner"})}),"\n",(0,s.jsx)(n.p,{children:"LlamaFirewall is a modular security system that allows developers to create custom scanners to detect and prevent specific types of threats. In this guide, we will walk you through the process of creating a new custom scanner for LlamaFirewall."}),"\n",(0,s.jsx)(n.h3,{id:"step-1-define-your-scanners-purpose-and-functionality",children:"Step 1: Define your scanner's purpose and functionality"}),"\n",(0,s.jsx)(n.p,{children:"Before creating your custom scanner, define its purpose and functionality. What type of threat do you want to detect? What kind of input data will your scanner process? Answering these questions will help you design an effective scanner."}),"\n",(0,s.jsx)(n.h3,{id:"step-2-create-a-new-scanner-class",children:"Step 2: Create a New Scanner Class"}),"\n",(0,s.jsxs)(n.p,{children:["Create a new Python class that inherits from the ",(0,s.jsx)(n.code,{children:"BaseScanner"})," class:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from llamafirewall.scanners.base_scanner import BaseScanner\n\nclass MyCustomScanner(BaseScanner):\n    def __init__(self, config):\n        super().__init__(config)\n        # Initialize your scanner's configuration and settings\n\n    def scan(self, input_data):\n        # Implement your scanner's logic to detect threats in the input data\n        pass\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-implement-your-scanners-logic",children:"Step 3: Implement Your Scanner's Logic"}),"\n",(0,s.jsxs)(n.p,{children:["Implement the ",(0,s.jsx)(n.code,{children:"scan"})," method to detect threats in the input data. You can use various techniques such as token analysis, keyword detection, contextual analysis, and heuristics-based detection."]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-register-your-scanner",children:"Step 4: Register Your Scanner"}),"\n",(0,s.jsxs)(n.p,{children:["Register your scanner with the LlamaFirewall system by adding it to the ",(0,s.jsx)(n.code,{children:"create_scanner"})," function of ",(0,s.jsx)(n.code,{children:"llamafirewall"})," class:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"elif scanner_type == ScannerType.MY_CUSTOM_SCANNER:\n    return MyCustomScanner()\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example Code"})}),"\n",(0,s.jsx)(n.p,{children:"Here is an example of a simple custom scanner that detects a specific keyword in the input data:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from llamafirewall.scanners.base_scanner import BaseScanner\n\nclass MyKeywordScanner(BaseScanner):\n    def __init__(self, config):\n        super().__init__(config)\n        self.keyword = "malicious"\n\n    def scan(self, input_data):\n        if self.keyword in input_data:\n            return True\n        return False\n'})}),"\n",(0,s.jsxs)(n.p,{children:["and then register it in the ",(0,s.jsx)(n.code,{children:"create_scanner"})," function:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"...\nelif scanner_type == ScannerType.MY_KEYWORD_SCANNER:\n    return MyKeywordScanner()\n"})}),"\n",(0,s.jsxs)(n.p,{children:["And that's pretty much it! Adding a new scanner for LlamaFirewall can be done in a manageable amount of steps, with the bulk of the work being defined in the ",(0,s.jsx)(n.code,{children:"scan"})," method. You will note that the complexity of your scanner will depend on the logic you want to set in place to detect threats, so be sure to follow best practices to keep a good balance between performance and effectiveness."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);